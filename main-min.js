var playerLibrary=new Vue({el:"#player-library",data:{main_playlist:[],play_track_id:-1},methods:{playThis:function(t){player.current_track.track_id==t?player.changePlayerState():(player.current_track=this.main_playlist[t],player.changeTrack())}},mounted(){fetch("data.json").then(t=>t.json()).then(t=>{this.main_playlist=t}).catch(t=>{console.error(t)})}}),player=new Vue({el:".js-player",data:{current_track:{track_id:null,filename:"",playtime:"--:--",duration:0,title:"",artist:""},is_playing:!1,is_loop:!1,is_muted:!1,is_modal_player_showed:!1,is_user_close_modalplayer:!1,is_random:!1,audio:"",playtime:-1,current_play_pos:0,duration:""},methods:{changePlayerState:function(){null==this.current_track.track_id&&(this.current_track=playerLibrary.main_playlist[0],this.changeTrack()),this.is_playing?this.audio.pause():this.audio.play(),this.is_playing=!this.is_playing},formatTime:function(t){var i;if(t>=0){var a=Math.floor(t/60),r=Math.floor(t%60);i=a+":"+(r<10?"0"+r:r)}else i="--:--";return i},toggleLoop:function(){this.is_loop=!this.is_loop,this.audio.loop=this.is_loop},changeTrack:function(){this.audio.pause(),this.audio.src=this.current_track.filename,this.audio.load(),this.audio.play(),playerLibrary.play_track_id=this.current_track.track_id,this.openModalPlayer()},openModalPlayer:function(t=!1){(!this.is_user_close_modalplayer||t)&&document.body.clientWidth<540&&(this.is_modal_player_showed=!0)},switchPrev:function(){this.current_track.track_id>0&&(this.current_track=playerLibrary.main_playlist[this.current_track.track_id-1],this.changeTrack())},switchNext:function(){if(this.is_random){var t=Math.round(Math.random()*playerLibrary.main_playlist.length);this.current_track=playerLibrary.main_playlist[t]}else null==this.current_track.track_id||this.current_track.track_id==playerLibrary.main_playlist.length-1?this.current_track=playerLibrary.main_playlist[0]:this.current_track=playerLibrary.main_playlist[this.current_track.track_id+1];this.changeTrack()},rewindTrack:function(){this.audio.currentTime+10<this.audio.duration&&(this.audio.currentTime+=10)},toggleMute:function(){this.is_muted=!this.is_muted,this.audio.muted=this.is_muted}},mounted(){this.audio=new Audio(this.current_track.path),this.audio.load(),$(".js-slider").slider({orientation:"horizontal",min:0,max:1e4,range:"min",slide:(t,i)=>{this.audio.currentTime=this.current_track.duration*i.value/1e4},start:()=>{this.audio.played&&null!==this.current_track.track_id&&this.audio.pause()},stop:()=>{this.audio.paused&&null!==this.current_track.track_id&&this.audio.play()}}),$(".volume-control-slider").slider({orientation:"vertical",min:0,max:100,value:100,range:"min",slide:(t,i)=>{this.audio.volume=i.value/100},stop:(t,i)=>{0==i.value&&this.toggleMute()}}),this.audio.addEventListener("timeupdate",()=>{if(this.audio.currentTime>0){var t=this.audio.currentTime/this.current_track.duration*1e4;this.current_play_pos=t,this.playtime=this.audio.currentTime,$(".js-slider").slider("value",t)}}),this.audio.addEventListener("pause",()=>{null!==this.current_track.track_id&&(this.is_playing=!1)}),this.audio.addEventListener("play",()=>{null!==this.current_track.track_id&&(this.is_playing=!0)}),this.audio.addEventListener("ended",()=>{this.is_loop||this.switchNext()})}});